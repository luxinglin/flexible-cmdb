<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/main.css">
    <title>Haier CMDB</title>
</head>

<body>

<div role="navigation" class="navbar navbar-default navbar-static-top">
    <div class="container">
        <div class="row">
            <div class="navbar-header col-sm-4 col-md-4">
                <div class="logo-well">
                    <a href="#">
                        <img src="assets/img/cmdb-logo.svg" alt="Neo4j World's Leading Graph Database" id="logo">
                    </a>
                </div>
                <div class="navbar-brand">
                    <div class="brand">Haier CMDB</div>
                </div>
            </div>

            <div class="navbar-header col-sm-4 col-md-4" style="padding-top: 15px;">
                <a href="ci.html">配置项</a>&nbsp;&nbsp;&nbsp;&nbsp;
                <a href="ci-relation.html">关系图</a>
            </div>

            <div class="col-sm-4 col-md-4">
                <ul class="nav navbar-nav">
                    <li>
                        <form role="search" class="navbar-form" id="search">
                            <div class="form-group">
                                <select id="ciTypeSelect" class="form-control"
                                        name="ciType" onchange="filterCiSelect()"></select>
                            </div>
                        </form>
                    </li>
                </ul>
            </div>

        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <!--新增业务系统 BEGIN-->
        <div id="add_BizSystemConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增业务系统</div>
            <div class="row">
                <form id="newBizSystemConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="bizSystem.nameForInsert" class="col-sm-3 control-label">系统名称：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="name" id="bizSystem.nameForInsert"
                                   placeholder="系统名称"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="codeForInsert" class="col-sm-3 control-label">系统编码：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="code" id="codeForInsert" placeholder="系统编码">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bizSystemDescForInsert" class="col-sm-3 control-label">系统描述：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="bizSystemDesc" id="bizSystemDescForInsert"
                                   placeholder="系统描述">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bizContactIdStrForInsert" class="col-sm-3 control-label">业务接口人：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="bizContactIdStr" multiple id="bizContactIdStrForInsert"
                                    placeholder="业务接口人"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bizRelationIdStrForInsert" class="col-sm-3 control-label">业务关系人：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="bizRelationIdStr" multiple id="bizRelationIdStrForInsert"
                                    placeholder="业务关系人"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="serverSetForInsert" class="col-sm-3 control-label">部署服务器：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="serverIdStr" multiple id="serverSetForInsert"
                                    placeholder="部署服务器"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addBizSystemConfigItemBtn">Add</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
        <!--新增业务系统 END-->

        <!--新增服务器 BEGIN-->
        <div id="add_ServerConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增服务器</div>
            <div class="row">
                <form id="newServerConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="server.nameForInsert" class="col-sm-2 control-label">名称：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="name" id="server.nameForInsert"
                                   placeholder="名称"
                                   required>
                        </div>
                        <label for="server_snForInsert" class="col-sm-2 control-label">序列号：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="sn" id="server_snForInsert" placeholder="序列号"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="uuidForInsert" class="col-sm-2 control-label">UUID：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="uuid" id="uuidForInsert" placeholder="UUID">
                        </div>
                        <label for="serverTypeForInsert" class="col-sm-2 control-label">服务器类型：</label>
                        <div class="col-sm-4">
                            <select type="text" class="form-control" name="serverType" id="serverTypeForInsert"
                                    placeholder="UUID">
                                <option value="">-请选择-</option>
                                <option value="1">物理机</option>
                                <option value="2">虚拟机</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="manageIpForInsert" class="col-sm-2 control-label">管理IP：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="manageIp" id="manageIpForInsert"
                                   placeholder="管理IP">
                        </div>
                        <label for="brandForInsert" class="col-sm-2 control-label">品牌：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="brand" id="brandForInsert"
                                   placeholder="品牌">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_modelForInsert" class="col-sm-2 control-label">型号：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="model" id="server_modelForInsert"
                                   placeholder="型号">
                        </div>
                        <label for="server_ownerIdStrForInsert" class="col-sm-2 control-label">责任人：</label>
                        <div class="col-sm-4">
                            <select type="text" class="form-control" name="ownerIdStr" id="server_ownerIdStrForInsert"
                                    placeholder="责任人"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_runStatusForInsert" class="col-sm-2 control-label">运行状态：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="runStatus" id="server_runStatusForInsert"
                                   placeholder="运行状态">
                        </div>
                        <label for="server_locationDescForInsert" class="col-sm-2 control-label">所在位置：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="locationDesc"
                                   id="server_locationDescForInsert"
                                   placeholder="所在位置">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_usePurposeForInsert" class="col-sm-2 control-label">用途：</label>
                        <div class="col-sm-4">
                            <textarea type="text" class="form-control" name="usePurpose" id="server_usePurposeForInsert"
                                      placeholder="用途"></textarea>
                        </div>
                        <label for="server_usePurposeForInsert" class="col-sm-2 control-label">OS类型：</label>
                        <div class="col-sm-4">
                            <select type="text" class="form-control" name="osFamily" id="server_osFamilyForInsert"
                                    placeholder="OS类型">
                                <option value="">-请选择-</option>
                                <option value="1">Windows</option>
                                <option value="2">Redhat</option>
                                <option value="3">CentOS</option>
                                <option value="4">Ubuntu</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_osVersionForInsert" class="col-sm-2 control-label">OS版本：</label>
                        <div class="col-sm-4">
                            <textarea type="text" class="form-control" name="osVersion" id="server_osVersionForInsert"
                                      placeholder="OS版本"></textarea>
                        </div>
                        <label for="server_cpuNumForInsert" class="col-sm-2 control-label">CPU数量：</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control" name="cpuNum" id="server_cpuNumForInsert"
                                   placeholder="CPU数量">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_diskNumForInsert" class="col-sm-2 control-label">磁盘数量：</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control" name="diskNum" id="server_diskNumForInsert"
                                   placeholder="磁盘数量">
                        </div>
                        <label for="server_diskInitSizeForInsert" class="col-sm-2 control-label">容量：</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control" name="diskInitSize"
                                   id="server_diskInitSizeForInsert"
                                   placeholder="容量">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_networkCardModelForInsert" class="col-sm-2 control-label">网卡型号：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="networkCardModel"
                                   id="server_networkCardModelForInsert"
                                   placeholder="网卡型号">
                        </div>
                        <label for="server_networkCardNumForInsert" class="col-sm-2 control-label">网卡数量：</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control" name="networkCardNum"
                                   id="server_networkCardNumForInsert"
                                   placeholder="网卡数量">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="server_networkIdStrForInsert" class="col-sm-2 control-label">连接交换机：</label>
                        <div class="col-sm-4">
                            <select type="text" class="form-control" multiple name="networkIdStr"
                                    id="server_networkIdStrForInsert"
                                    placeholder="连接交换机"></select>
                        </div>
                        <label for="server_networkCardNumForInsert" class="col-sm-2 control-label">连接存储：</label>
                        <div class="col-sm-4">
                            <select type="text" class="form-control" multiple name="storageIdStr"
                                    id="server_storageIdStrForInsert"
                                    placeholder="连接存储"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addServerConfigItemBtn">Add</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--新增服务器 END-->

        <!--新增密码信息 BEGIN-->
        <div id="add_PasswordConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增密码信息</div>
            <div class="row">
                <form id="newPasswordConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="password.nameForInsert" class="col-sm-3 control-label">密码名称：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="name" id="password.nameForInsert"
                                   placeholder="密码名称"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="userNameForInsert" class="col-sm-3 control-label">用户名：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="userName" id="userNameForInsert"
                                   placeholder="用户名"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="passwordForInsert" class="col-sm-3 control-label">密码：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="password" id="passwordForInsert"
                                   placeholder="密码">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="remarkForInsert" class="col-sm-3 control-label">备注：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="remark" id="remarkForInsert"
                                   placeholder="备注">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bizSystemIdStrForInsert" class="col-sm-3 control-label">所属系统：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="bizSystemIdStr" multiple id="bizSystemIdStrForInsert"
                                    placeholder="所属系统"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="serverIdStrForInsert" class="col-sm-3 control-label">所属服务器：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="serverIdStr" multiple id="serverIdStrForInsert"
                                    placeholder="所属服务器"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addPasswordConfigItemBtn">Add</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--新增密码信息 END-->

        <!--新增网络设备信息 BEGIN-->
        <div id="add_NetworkConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增网络设备信息</div>
            <div class="row">
                <form id="newNetworkConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="network.nameForInsert" class="col-sm-3 control-label">设备名称：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="name" id="network.nameForInsert"
                                   placeholder="设备名称"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="network.snNameForInsert" class="col-sm-3 control-label">序列号：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="sn" id="network.snNameForInsert"
                                   placeholder="序列号"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="networkTypeForInsert" class="col-sm-3 control-label">设备类型：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="networkType" id="networkTypeForInsert"
                                   placeholder="设备类型">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="network.runStatusForInsert" class="col-sm-3 control-label">运行状态：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="runStatus" id="network.runStatusForInsert"
                                   placeholder="运行状态">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addNetworkConfigItemBtn">Add</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--新增网络设备信息 END-->

        <!--新增存储设备信息 BEGIN-->
        <div id="add_StorageConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增存储设备信息</div>
            <div class="row">
                <form id="newStorageConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="storage.nameForInsert" class="col-sm-3 control-label">存储名称：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="name" id="storage.nameForInsert"
                                   placeholder="存储名称"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="storage.brandForInsert" class="col-sm-3 control-label">品牌：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="brand" id="storage.brandForInsert"
                                   placeholder="品牌"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="storage.runStatusForInsert" class="col-sm-3 control-label">运行状态：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="runStatus" id="storage.runStatusForInsert"
                                   placeholder="运行状态">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="storage.usePurposeForInsert" class="col-sm-3 control-label">用途：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="usePurpose" id="storage.usePurposeForInsert"
                                   placeholder="用途">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addStorageConfigItemBtn">Add</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--新增存储设备信息 END-->

        <!--新增中间件信息 BEGIN-->
        <div id="add_MiddlewareConfigItem" style="display: none" class="panel panel-default">
            <div class="panel-heading">新增中间件信息</div>
            <div class="row">
                <form id="newMiddlewareConfigItemForm" class="form-horizontal addlabel">
                    <div class="form-group">
                        <label for="middleware.nameForInsert" class="col-sm-2 control-label">中间件名称：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="name" id="middleware.nameForInsert"
                                   placeholder="中间件名称"
                                   required>
                        </div>
                        <label for="middlewareTypeForInsert" class="col-sm-2 control-label">类型：</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" name="middlewareType" id="middlewareTypeForInsert"
                                   placeholder="类型"
                                   required>
                        </div>
                    </div>
                    <div class="form-group">

                    </div>
                    <div class="form-group">
                        <label for="middleware_serverIdStrForInsert" class="col-sm-3 control-label">部署服务器：</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="serverIdStr" id="middleware_serverIdStrForInsert"
                                    placeholder="部署服务器"
                                    required></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="middleware.usePurposeForInsert" class="col-sm-3 control-label">用途：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="usePurpose"
                                   id="middleware.usePurposeForInsert"
                                   placeholder="用途">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="configFilePathForInsert" class="col-sm-3 control-label">配置文件路径：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="configFilePath" id="configFilePathForInsert"
                                   placeholder="配置文件路径">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="logFilePathForInsert" class="col-sm-3 control-label">日志文件路径：</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" name="logFilePath" id="logFilePathForInsert"
                                   placeholder="日志文件路径">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="configParamDescForInsert" class="col-sm-3 control-label">配置参数描述：</label>
                        <div class="col-sm-8">
                            <textarea class="form-control" name="configParamDesc" id="configParamDescForInsert"
                                      placeholder="配置参数描述" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3"></label>
                        <div class="col-sm-8 pull-right">
                            <button class="btn btn-default" type="button" id="addMiddlewareConfigItemBtn">Add</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!--新增密码信息 END-->
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">查询结果</div>
            <table id="results" class="table table-striped table-hover">
                <thead>

                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
    function search() {
        var val = $("#ciTypeSelect").val();
        var url = "";
        var head = $("table#results thead").empty();
        if (val === 'BizSystemConfigItem') {
            $(" <tr>\n" +
                "                    <th>系统名称</th>\n" +
                "                    <th>系统编码</th>\n" +
                "                    <th>系统描述</th>\n" +
                "                    <th>关联人员</th>\n" +
                "                    <th>关联服务器</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
            url = "/bizSystems/findList?name=";
        } else if (val === 'PasswordConfigItem') {
            url = "/passwords/?name=";
            $(" <tr>\n" +
                "                    <th>密码名称</th>\n" +
                "                    <th>用户名</th>\n" +
                "                    <th>密码</th>\n" +
                "                    <th>备注</th>\n" +
                "                    <th>关联信息</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
        } else if (val === 'ServerConfigItem') {
            url = "/servers/?name=";
            $(" <tr>\n" +
                "                    <th>服务器名称</th>\n" +
                "                    <th>序列号</th>\n" +
                "                    <th>责任人</th>\n" +
                "                    <th>管理IP</th>\n" +
                "                    <th>运行状态</th>\n" +
                "                    <th>所在位置</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
        } else if (val === 'PersonConfigItem') {
            url = "/persons/?name=";
            $(" <tr>\n" +
                "                    <th>姓名</th>\n" +
                "                    <th>电话</th>\n" +
                "                    <th>邮箱</th>\n" +
                "                </tr>").appendTo(head);
        } else if (val === 'NetworkConfigItem') {
            url = "/networks/?name=";
            $(" <tr>\n" +
                "                    <th>设备名称</th>\n" +
                "                    <th>序列号</th>\n" +
                "                    <th>设备类型</th>\n" +
                "                    <th>管理IP</th>\n" +
                "                    <th>责任人</th>\n" +
                "                    <th>运行状态</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
        } else if (val === 'StorageConfigItem') {
            url = "/storages/?name=";
            $(" <tr>\n" +
                "                    <th>设备名称</th>\n" +
                "                    <th>序列号</th>\n" +
                "                    <th>责任人</th>\n" +
                "                    <th>运行状态</th>\n" +
                "                    <th>容量</th>\n" +
                "                    <th>传输速率</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
        } else if (val === 'MiddlewareConfigItem') {
            url = "/middlewares/?name=";
            $(" <tr>\n" +
                "                    <th>名称</th>\n" +
                "                    <th>中间件类型</th>\n" +
                "                    <th>配置文件路径</th>\n" +
                "                    <th>日志文件路径</th>\n" +
                "                    <th>配置参数描述</th>\n" +
                "                    <th>操作</th>\n" +
                "                </tr>").appendTo(head);
        }
        //数据清理
        var t = $("table#results tbody").empty();
        $.get(url,
            function (data) {
                console.log(val);
                if (!data) return;
                data = data.data;
                if (data.length < 1) return;
                data.forEach(function (item) {
                    if (val === "BizSystemConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.code + "</td><td>" + item.bizSystemDesc + "</td><td>" + 0 + "</td><td>" + item.serverSet.length + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    } else if (val === "PasswordConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.userName + "</td><td>" + item.password + "</td><td>" + item.remark + "</td><td>" + item.passwordForRelations.length + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    } else if (val === "ServerConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.sn + "</td><td>" + item.ownerName + "</td><td>" + item.manageIp + "</td><td>" + item.runStatus + "</td><td>" + item.locationDesc + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    } else if (val === "PersonConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.mobile + "</td><td>" + item.email + "</td>").appendTo(t);
                    } else if (val === "NetworkConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.sn + "</td><td>" + item.networkType + "</td><td>" + item.manageIp + "</td><td>" + item.ownerName + "</td><td>" + item.runStatus + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    } else if (val === "StorageConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.sn + "</td><td>" + item.ownerName + "</td><td>" + item.runStatus + "</td><td>" + item.totalVolume + "</td><td>" + item.transmissionSpeed + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    } else if (val === "MiddlewareConfigItem") {
                        $("<tr><td class='movie'>" + item.name + "</td><td>" + item.middlewareType + "</td><td>" + item.configFilePath + "</td><td>" + item.logFilePath + "</td><td>" + item.configParamDesc + "</td><td><a href='#' onclick='deleteItem(" + item.id + ")'>删除</a></td></tr>").appendTo(t);
                    }
                });
            }, "json");
        return false;
    }

    $(function () {
        /**
         * 新增业务系统配置项
         */
        $("#addBizSystemConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/bizSystems",
                data: $("#newBizSystemConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });

        /**
         * 新增服务器
         */
        $("#addServerConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/servers",
                data: $("#newServerConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });

        /**
         * 新增密码信息
         * */
        $("#addPasswordConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/passwords",
                data: $("#newPasswordConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });

        /**
         * 新增网络设备信息
         * */
        $("#addNetworkConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/networks",
                data: $("#newNetworkConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });
        /**
         * 新增存储设备信息
         * */
        $("#addStorageConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/storages",
                data: $("#newStorageConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });
        /**
         * 新增中间件信息
         * */
        $("#addMiddlewareConfigItemBtn").on("click", function () {
            $.ajax({
                url: "/middlewares",
                data: $("#newMiddlewareConfigItemForm").serialize(),
                type: "POST",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        search();
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        });

        /**
         * 加载配置项类型下拉框
         */
        $.ajax({
            url: "/configItem",
            type: "GET",
            dataType: 'json',
            success: function (data) {
                if (data.status) {
                    $("#ciTypeSelect").empty();
                    var idx = 0;
                    var id = 0;
                    data.data.forEach(function (item) {
                        if (idx == 0) {
                            id = item.value;
                        }
                        $("#ciTypeSelect").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        idx = idx + 1;
                    });
                    refreshCiSelect(id);
                }
            },
            error: function (er) {
                console.log(er)
            }
        });

        /**
         * 加载人员列表
         */
        $.ajax({
            url: "/configItem/PersonConfigItem",
            type: "GET",
            dataType: "json",
            success: function (data) {
                $("#bizContactIdStrForInsert").empty();
                $("#bizRelationIdStrForInsert").empty();
                $("#server_ownerIdStrForInsert").empty();
                if (data.status) {
                    data.data.forEach(function (item) {
                        $("#bizContactIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        $("#bizRelationIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        $("#server_ownerIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                    });
                }
            }
        });

        /**
         * 加载服务器列表
         */
        $.ajax({
            url: "/configItem/ServerConfigItem",
            type: "GET",
            dataType: "json",
            success: function (data) {
                $("#serverSetForInsert").empty();
                $("#serverIdStrForInsert").empty();
                $("#middleware_serverIdStrForInsert").empty();
                if (data.status) {
                    data.data.forEach(function (item) {
                        $("#serverSetForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        $("#serverIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        $("#middleware_serverIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                    });
                }
            }
        });

        /**
         * 加载系统列表
         */
        $.ajax({
            url: "/configItem/BizSystemConfigItem",
            type: "GET",
            dataType: "json",
            success: function (data) {
                $("#bizSystemIdStrForInsert").empty();
                if (data.status) {
                    data.data.forEach(function (item) {
                        $("#bizSystemIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                    });
                }
            }
        });
        /**
         * 加载交换机列表
         */
        $.ajax({
            url: "/configItem/NetworkConfigItem",
            type: "GET",
            dataType: "json",
            success: function (data) {
                $("#server_networkIdStrForInsert").empty();
                if (data.status) {
                    data.data.forEach(function (item) {
                        $("#server_networkIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                    });
                }
            }
        });
        /**
         * 加载存储设备列表
         */
        $.ajax({
            url: "/configItem/StorageConfigItem",
            type: "GET",
            dataType: "json",
            success: function (data) {
                $("#server_storageIdStrForInsert").empty();
                if (data.status) {
                    data.data.forEach(function (item) {
                        $("#server_storageIdStrForInsert").append("<option value='" + item.value + "'>" + item.name + "</option>");
                    });
                }
            }
        });



    });

    function refreshCiSelect(val) {
        if (val != "") {
            //新增配置项form显隐切换
            $("div[id^=add_]").each(function () {
                $(this).css("display", "none");
            });
            $("#add_" + val).css("display", "block");
            //数据列表更新
            search();

            $.ajax({
                url: "/configItem/" + val,
                type: "GET",
                dataType: 'json',
                success: function (data) {
                    if (data.status) {
                        data.data.forEach(function (item) {
                            $("#ciSelect").append("<option value='" + item.value + "'>" + item.name + "</option>");
                        });
                        $("#ciSelect").prepend("<option value='' selected>--请选择--</option>");
                    }
                },
                error: function (er) {
                    console.log(er)
                }
            });
        } else {
            $("#ciSelect").prepend("<option value='' selected>--请选择--</option>");
        }
    }

    /**
     * 筛选出ci信息
     */
    function filterCiSelect() {
        $("#ciSelect").empty();
        var val = $("#ciTypeSelect").val();
        refreshCiSelect(val);
    }

    /**
     * 配置项删除操作
     * @param id
     */
    function deleteItem(id) {
        console.log("to delete id: " + id);
        var val = $("#ciTypeSelect").val();
        var url = "";
        if (val === "BizSystemConfigItem") {
            url = "/bizSystems/" + id;
        } else if (val === "PasswordConfigItem") {
            url = "/passwords/" + id;
        } else if (val === "ServerConfigItem") {
            url = "/servers/" + id;
        } else if (val === "NetworkConfigItem") {
            url = "/networks/" + id;
        } else if (val === "StorageConfigItem") {
            url = "/storages/" + id;
        } else if (val === "MiddlewareConfigItem") {
            url = "/middlewares/" + id;
        }
        $.ajax({
            url: url,
            type: "DELETE",
            dataType: 'json',
            success: function (data) {
                if (data.status) {
                    search();
                }
            },
            error: function (er) {
                console.log(er)
            }
        });
    }
</script>

</body>
</html>
